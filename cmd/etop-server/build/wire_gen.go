// Code generated by Wire. DO NOT EDIT.

//go:generate wire
//+build !wireinject

package build

import (
	"context"
	"o.o/backend/cmd/etop-server/config"
	"o.o/backend/cogs/base/producer"
	"o.o/backend/cogs/config/_server"
	"o.o/backend/cogs/database/_all"
	"o.o/backend/cogs/payment/_all"
	"o.o/backend/cogs/server/admin"
	"o.o/backend/cogs/server/kpay"
	"o.o/backend/cogs/server/main/_max"
	"o.o/backend/cogs/server/shop"
	"o.o/backend/cogs/server/vtpay"
	"o.o/backend/cogs/shipment/_all"
	"o.o/backend/cogs/shipment/ghtk"
	"o.o/backend/cogs/shipment/ntx"
	"o.o/backend/cogs/shipment/vtpost"
	_all3 "o.o/backend/cogs/shipment/webhook/_all"
	"o.o/backend/cogs/shipnow/_all"
	"o.o/backend/cogs/sms/_all"
	"o.o/backend/cogs/storage/_all"
	_all2 "o.o/backend/cogs/telecom/_all"
	"o.o/backend/cogs/ticket/_all"
	"o.o/backend/cogs/uploader"
	aggregate28 "o.o/backend/com/etc/logging/payment/aggregate"
	"o.o/backend/com/etc/logging/shippingwebhook"
	"o.o/backend/com/etc/logging/smslog/aggregate"
	aggregate23 "o.o/backend/com/etelecom/aggregate"
	pm19 "o.o/backend/com/etelecom/pm"
	"o.o/backend/com/etelecom/pm/portsip_pm"
	provider2 "o.o/backend/com/etelecom/provider"
	query22 "o.o/backend/com/etelecom/query"
	"o.o/backend/com/etelecom/usersetting"
	pm23 "o.o/backend/com/etelecom/usersetting/pm"
	"o.o/backend/com/eventhandler/notifier"
	sqlstore2 "o.o/backend/com/eventhandler/notifier/sqlstore"
	server2 "o.o/backend/com/external/payment/kpay/gateway/server"
	manager2 "o.o/backend/com/external/payment/manager"
	aggregate9 "o.o/backend/com/external/payment/payment/aggregate"
	query28 "o.o/backend/com/external/payment/payment/query"
	vtpay2 "o.o/backend/com/external/payment/vtpay"
	aggregate27 "o.o/backend/com/external/payment/vtpay/gateway/aggregate"
	"o.o/backend/com/external/payment/vtpay/gateway/server"
	"o.o/backend/com/fabo/main/fbmessaging"
	redis2 "o.o/backend/com/fabo/pkg/redis"
	aggregate6 "o.o/backend/com/main/accountshipnow/aggregate"
	query15 "o.o/backend/com/main/accountshipnow/query"
	"o.o/backend/com/main/address"
	aggregate3 "o.o/backend/com/main/authorization/aggregate"
	"o.o/backend/com/main/bankstatement"
	aggregate4 "o.o/backend/com/main/catalog/aggregate"
	pm4 "o.o/backend/com/main/catalog/pm"
	query5 "o.o/backend/com/main/catalog/query"
	aggregate8 "o.o/backend/com/main/connectioning/aggregate"
	"o.o/backend/com/main/connectioning/manager"
	pm16 "o.o/backend/com/main/connectioning/pm"
	query16 "o.o/backend/com/main/connectioning/query"
	aggregate21 "o.o/backend/com/main/contact/aggregate"
	query26 "o.o/backend/com/main/contact/query"
	"o.o/backend/com/main/credit"
	pm25 "o.o/backend/com/main/credit/pm"
	aggregate25 "o.o/backend/com/main/department/aggregate"
	"o.o/backend/com/main/department/query"
	"o.o/backend/com/main/identity"
	"o.o/backend/com/main/identity/pm"
	aggregate5 "o.o/backend/com/main/inventory/aggregate"
	pm2 "o.o/backend/com/main/inventory/pm"
	query10 "o.o/backend/com/main/inventory/query"
	aggregate2 "o.o/backend/com/main/invitation/aggregate"
	pm3 "o.o/backend/com/main/invitation/pm"
	query2 "o.o/backend/com/main/invitation/query"
	"o.o/backend/com/main/invoicing"
	pm21 "o.o/backend/com/main/invoicing/pm"
	aggregate13 "o.o/backend/com/main/ledgering/aggregate"
	pm5 "o.o/backend/com/main/ledgering/pm"
	query23 "o.o/backend/com/main/ledgering/query"
	"o.o/backend/com/main/location"
	aggregate26 "o.o/backend/com/main/moneytx/aggregate"
	pm6 "o.o/backend/com/main/moneytx/pm"
	query19 "o.o/backend/com/main/moneytx/query"
	"o.o/backend/com/main/ordering"
	pm7 "o.o/backend/com/main/ordering/pm"
	aggregate14 "o.o/backend/com/main/purchaseorder/aggregate"
	pm8 "o.o/backend/com/main/purchaseorder/pm"
	query12 "o.o/backend/com/main/purchaseorder/query"
	aggregate18 "o.o/backend/com/main/purchaserefund/aggregate"
	pm9 "o.o/backend/com/main/purchaserefund/pm"
	query14 "o.o/backend/com/main/purchaserefund/query"
	aggregate10 "o.o/backend/com/main/receipting/aggregate"
	pm10 "o.o/backend/com/main/receipting/pm"
	query11 "o.o/backend/com/main/receipting/query"
	aggregate17 "o.o/backend/com/main/refund/aggregate"
	pm11 "o.o/backend/com/main/refund/pm"
	query13 "o.o/backend/com/main/refund/query"
	query29 "o.o/backend/com/main/reporting/query"
	"o.o/backend/com/main/shipmentpricing/pricelist"
	pm17 "o.o/backend/com/main/shipmentpricing/pricelist/pm"
	"o.o/backend/com/main/shipmentpricing/pricelistpromotion"
	"o.o/backend/com/main/shipmentpricing/shipmentprice"
	"o.o/backend/com/main/shipmentpricing/shipmentservice"
	"o.o/backend/com/main/shipmentpricing/shopshipmentpricelist"
	"o.o/backend/com/main/shipnow"
	carrier2 "o.o/backend/com/main/shipnow/carrier"
	pm12 "o.o/backend/com/main/shipnow/pm"
	aggregate16 "o.o/backend/com/main/shipping/aggregate"
	"o.o/backend/com/main/shipping/carrier"
	pm13 "o.o/backend/com/main/shipping/pm"
	query18 "o.o/backend/com/main/shipping/query"
	query17 "o.o/backend/com/main/shippingcode/query"
	aggregate15 "o.o/backend/com/main/stocktaking/aggregate"
	query9 "o.o/backend/com/main/stocktaking/query"
	aggregate24 "o.o/backend/com/main/transaction/aggregate"
	pm22 "o.o/backend/com/main/transaction/pm"
	query21 "o.o/backend/com/main/transaction/query"
	"o.o/backend/com/report/reportserver"
	affiliate2 "o.o/backend/com/services/affiliate"
	pm14 "o.o/backend/com/services/affiliate/pm"
	aggregate12 "o.o/backend/com/shopping/carrying/aggregate"
	query6 "o.o/backend/com/shopping/carrying/query"
	aggregate7 "o.o/backend/com/shopping/customering/aggregate"
	pm18 "o.o/backend/com/shopping/customering/pm"
	query3 "o.o/backend/com/shopping/customering/query"
	aggregate22 "o.o/backend/com/shopping/setting/aggregate"
	query24 "o.o/backend/com/shopping/setting/query"
	"o.o/backend/com/shopping/setting/util"
	aggregate11 "o.o/backend/com/shopping/suppliering/aggregate"
	query7 "o.o/backend/com/shopping/suppliering/query"
	aggregate29 "o.o/backend/com/shopping/tradering/aggregate"
	pm15 "o.o/backend/com/shopping/tradering/pm"
	query8 "o.o/backend/com/shopping/tradering/query"
	"o.o/backend/com/subscripting/subscription"
	pm20 "o.o/backend/com/subscripting/subscription/pm"
	"o.o/backend/com/subscripting/subscriptionplan"
	"o.o/backend/com/subscripting/subscriptionproduct"
	query27 "o.o/backend/com/summary/etelecom/query"
	query20 "o.o/backend/com/summary/etop/query"
	aggregate20 "o.o/backend/com/supporting/ticket/aggregate"
	pm24 "o.o/backend/com/supporting/ticket/pm"
	"o.o/backend/com/supporting/ticket/provider"
	query4 "o.o/backend/com/supporting/ticket/query"
	aggregate19 "o.o/backend/com/web/webserver/aggregate"
	query25 "o.o/backend/com/web/webserver/query"
	"o.o/backend/pkg/common/apifw/captcha"
	"o.o/backend/pkg/common/apifw/health"
	auth2 "o.o/backend/pkg/common/authorization/auth"
	"o.o/backend/pkg/common/bus"
	"o.o/backend/pkg/common/redis"
	"o.o/backend/pkg/etop/api/admin"
	"o.o/backend/pkg/etop/api/admin/_all"
	"o.o/backend/pkg/etop/api/affiliate"
	"o.o/backend/pkg/etop/api/export"
	"o.o/backend/pkg/etop/api/integration"
	"o.o/backend/pkg/etop/api/root"
	"o.o/backend/pkg/etop/api/root/_all"
	"o.o/backend/pkg/etop/api/sadmin"
	"o.o/backend/pkg/etop/api/shop"
	"o.o/backend/pkg/etop/api/shop/_all"
	"o.o/backend/pkg/etop/api/shop/account"
	"o.o/backend/pkg/etop/api/shop/account_user"
	"o.o/backend/pkg/etop/api/shop/accountshipnow"
	"o.o/backend/pkg/etop/api/shop/authorize"
	"o.o/backend/pkg/etop/api/shop/brand"
	carrier3 "o.o/backend/pkg/etop/api/shop/carrier"
	"o.o/backend/pkg/etop/api/shop/category"
	"o.o/backend/pkg/etop/api/shop/collection"
	"o.o/backend/pkg/etop/api/shop/connection"
	"o.o/backend/pkg/etop/api/shop/contact"
	credit2 "o.o/backend/pkg/etop/api/shop/credit"
	"o.o/backend/pkg/etop/api/shop/customer"
	"o.o/backend/pkg/etop/api/shop/customergroup"
	"o.o/backend/pkg/etop/api/shop/department"
	"o.o/backend/pkg/etop/api/shop/etelecom"
	"o.o/backend/pkg/etop/api/shop/etelecom/etelecomuser"
	export2 "o.o/backend/pkg/etop/api/shop/export"
	"o.o/backend/pkg/etop/api/shop/fulfillment"
	"o.o/backend/pkg/etop/api/shop/history"
	"o.o/backend/pkg/etop/api/shop/inventory"
	"o.o/backend/pkg/etop/api/shop/invoice"
	"o.o/backend/pkg/etop/api/shop/jira"
	"o.o/backend/pkg/etop/api/shop/ledger"
	"o.o/backend/pkg/etop/api/shop/money_transaction"
	"o.o/backend/pkg/etop/api/shop/notification"
	"o.o/backend/pkg/etop/api/shop/order"
	"o.o/backend/pkg/etop/api/shop/payment"
	"o.o/backend/pkg/etop/api/shop/product"
	"o.o/backend/pkg/etop/api/shop/product_source"
	"o.o/backend/pkg/etop/api/shop/purchase_order"
	"o.o/backend/pkg/etop/api/shop/purchase_refund"
	"o.o/backend/pkg/etop/api/shop/receipt"
	"o.o/backend/pkg/etop/api/shop/refund"
	"o.o/backend/pkg/etop/api/shop/setting"
	"o.o/backend/pkg/etop/api/shop/shipment"
	shipnow2 "o.o/backend/pkg/etop/api/shop/shipnow"
	"o.o/backend/pkg/etop/api/shop/stocktake"
	subscription2 "o.o/backend/pkg/etop/api/shop/subscription"
	summary2 "o.o/backend/pkg/etop/api/shop/summary"
	"o.o/backend/pkg/etop/api/shop/supplier"
	"o.o/backend/pkg/etop/api/shop/ticket"
	"o.o/backend/pkg/etop/api/shop/trading"
	"o.o/backend/pkg/etop/api/shop/transaction"
	"o.o/backend/pkg/etop/api/shop/ws"
	"o.o/backend/pkg/etop/apix/authx"
	"o.o/backend/pkg/etop/apix/mc/vht"
	"o.o/backend/pkg/etop/apix/mc/vnp"
	"o.o/backend/pkg/etop/apix/partner"
	"o.o/backend/pkg/etop/apix/partnercarrier"
	"o.o/backend/pkg/etop/apix/partnerimport"
	"o.o/backend/pkg/etop/apix/shipping"
	"o.o/backend/pkg/etop/apix/shop"
	"o.o/backend/pkg/etop/apix/shopping"
	"o.o/backend/pkg/etop/apix/webhook"
	"o.o/backend/pkg/etop/authorize/auth"
	"o.o/backend/pkg/etop/authorize/middleware"
	"o.o/backend/pkg/etop/authorize/tokens"
	"o.o/backend/pkg/etop/eventstream"
	imcsv3 "o.o/backend/pkg/etop/logic/fulfillments/imcsv"
	"o.o/backend/pkg/etop/logic/hotfix/accountuser"
	"o.o/backend/pkg/etop/logic/hotfix/extension"
	"o.o/backend/pkg/etop/logic/hotfix/moneytx"
	"o.o/backend/pkg/etop/logic/hotfix/user"
	"o.o/backend/pkg/etop/logic/money-transaction/dhlimport"
	"o.o/backend/pkg/etop/logic/money-transaction/ghnimport"
	"o.o/backend/pkg/etop/logic/money-transaction/ghtkimport"
	"o.o/backend/pkg/etop/logic/money-transaction/handlers"
	"o.o/backend/pkg/etop/logic/money-transaction/jtexpressimport"
	"o.o/backend/pkg/etop/logic/money-transaction/njvimport"
	"o.o/backend/pkg/etop/logic/money-transaction/ntximport"
	"o.o/backend/pkg/etop/logic/money-transaction/snappyimport"
	"o.o/backend/pkg/etop/logic/money-transaction/vtpostimport"
	"o.o/backend/pkg/etop/logic/orders"
	"o.o/backend/pkg/etop/logic/orders/imcsv"
	imcsv2 "o.o/backend/pkg/etop/logic/products/imcsv"
	"o.o/backend/pkg/etop/logic/summary"
	"o.o/backend/pkg/etop/sqlstore"
	"o.o/backend/pkg/etop/sqlstore/telecom"
	"o.o/backend/pkg/integration/email"
	"o.o/backend/pkg/integration/jira/driver"
	"o.o/backend/pkg/integration/payment/kpay"
	"o.o/backend/pkg/integration/payment/vtpay"
	"o.o/backend/pkg/integration/payment/vtpay/client"
	"o.o/backend/pkg/integration/shipnow/ahamove"
	client2 "o.o/backend/pkg/integration/shipnow/ahamove/client"
	server3 "o.o/backend/pkg/integration/shipnow/ahamove/server"
	webhook7 "o.o/backend/pkg/integration/shipnow/ahamove/webhook"
	webhook2 "o.o/backend/pkg/integration/shipping/direct/webhook"
	"o.o/backend/pkg/integration/shipping/ghn/webhook/v1"
	"o.o/backend/pkg/integration/shipping/ghn/webhook/v2"
	webhook4 "o.o/backend/pkg/integration/shipping/ghtk/webhook"
	webhook3 "o.o/backend/pkg/integration/shipping/ninjavan/webhook"
	webhook6 "o.o/backend/pkg/integration/shipping/ntx/webhook"
	webhook5 "o.o/backend/pkg/integration/shipping/vtpost/webhook"
	"o.o/backend/pkg/integration/sms"
	"o.o/backend/pkg/services/affiliate/api"
)

// Injectors from wire.go:

func Build(ctx context.Context, cfg config.Config, partnerAuthURL partner.AuthURL) (Output, func(), error) {
	redisRedis := cfg.Redis
	store := redis.Connect(redisRedis)
	service := health.New(store)
	miscService := &root.MiscService{}
	policy := ProvidePolicy()
	authorizer := auth.New(policy)
	sharedConfig := cfg.SharedConfig
	sAdminToken := config_server.WireSAdminToken(sharedConfig)
	database_allConfig := cfg.Databases
	databases, err := database_all.BuildDatabases(database_allConfig)
	if err != nil {
		return Output{}, nil, err
	}
	mainDB := databases.Main
	queryService := identity.NewQueryService(mainDB)
	queryBus := identity.QueryServiceMessageBus(queryService)
	tokenStore := tokens.NewTokenStore(store)
	busBus := bus.New()
	addressStore := &sqlstore.AddressStore{
		DB: mainDB,
	}
	userStore := sqlstore.BuildUserStore(mainDB)
	userStoreInterface := sqlstore.BindUserStore(userStore)
	accountStore := &sqlstore.AccountStore{
		DB:           mainDB,
		EventBus:     busBus,
		AddressStore: addressStore,
		UserStore:    userStoreInterface,
	}
	accountStoreInterface := sqlstore.BindAccountStore(accountStore)
	partnerStore := sqlstore.BuildPartnerStore(mainDB)
	partnerStoreInterface := sqlstore.BindPartnerStore(partnerStore)
	accountUserStore := &sqlstore.AccountUserStore{
		DB:        mainDB,
		UserStore: userStoreInterface,
	}
	accountUserStoreInterface := sqlstore.BindAccountUserStore(accountUserStore)
	shopStore := &sqlstore.ShopStore{
		DB: mainDB,
	}
	shopStoreInterface := sqlstore.BindShopStore(shopStore)
	sessionStarter := &middleware.SessionStarter{
		SAdminToken:      sAdminToken,
		IdentityQuery:    queryBus,
		TokenStore:       tokenStore,
		AccountStore:     accountStoreInterface,
		UserStore:        userStoreInterface,
		PartnerStore:     partnerStoreInterface,
		AccountUserStore: accountUserStoreInterface,
		ShopStore:        shopStoreInterface,
	}
	session := config_server.NewSession(authorizer, sessionStarter, userStoreInterface, accountUserStoreInterface, sharedConfig, store)
	departmentQuery := query.NewDepartmentQuery(mainDB, queryBus)
	departmentQueryBus := query.DepartmentQueryMessageBus(departmentQuery)
	identityAggregate := identity.NewAggregate(mainDB, busBus, departmentQueryBus)
	commandBus := identity.AggregateMessageBus(identityAggregate)
	invitationQuery := query2.NewInvitationQuery(mainDB)
	invitationQueryBus := query2.InvitationQueryMessageBus(invitationQuery)
	notifierQueryService := notifier.NewQueryService(mainDB)
	notifyQueryBus := notifier.QueryServiceNotifyBus(notifierQueryService)
	notifierAggregate := notifier.NewNotifyAggregate(mainDB)
	notifyCommandBus := notifier.NewNotifyAggregateMessageBus(notifierAggregate)
	generator := auth2.NewGenerator(store)
	smsConfig := cfg.SMS
	whiteLabel := cfg.WhiteLabel
	v := sms_all.SupportedSMSDrivers(whiteLabel, smsConfig)
	logDB := databases.Log
	smsLogAggregate := aggregate.NewSmsLogAggregate(busBus, logDB)
	smslogCommandBus := aggregate.SmsLogAggregateMessageBus(smsLogAggregate)
	smsClient := sms.New(smsConfig, v, smslogCommandBus)
	smtpConfig := cfg.SMTP
	emailClient := email.New(smtpConfig)
	userStoreFactory := sqlstore.NewUserStore(mainDB)
	login := &sqlstore.Login{
		UserStore: userStoreInterface,
	}
	loginInterface := sqlstore.BindLogin(login)
	webphonePublicKey := cfg.WebphonePublicKey
	userService := &root.UserService{
		Session:           session,
		IdentityAggr:      commandBus,
		IdentityQuery:     queryBus,
		InvitationQuery:   invitationQueryBus,
		NotifyQuery:       notifyQueryBus,
		NotifyAggr:        notifyCommandBus,
		EventBus:          busBus,
		AuthStore:         generator,
		TokenStore:        tokenStore,
		RedisStore:        store,
		SMSClient:         smsClient,
		EmailClient:       emailClient,
		UserStore:         userStoreFactory,
		UserStoreIface:    userStoreInterface,
		ShopStore:         shopStoreInterface,
		AccountUserStore:  accountUserStoreInterface,
		LoginIface:        loginInterface,
		WebphonePublicKey: webphonePublicKey,
	}
	partnerStoreFactory := sqlstore.NewPartnerStore(mainDB)
	accountService := &root.AccountService{
		Session:           session,
		PartnerStore:      partnerStoreFactory,
		AccountStore:      accountStoreInterface,
		AccountUserStore:  accountUserStoreInterface,
		PartnerStoreIface: partnerStoreInterface,
	}
	locationQuery := location.New(mainDB)
	locationQueryBus := location.QueryMessageBus(locationQuery)
	locationService := &root.LocationService{
		Session:       session,
		LocationQuery: locationQueryBus,
	}
	bankService := &root.BankService{
		Session: session,
	}
	addressAggregate := address.NewAggregateAddress(busBus, mainDB, locationQueryBus)
	addressCommandBus := address.AddressAggregateMessageBus(addressAggregate)
	addressQueryService := address.NewQueryAddress(mainDB, busBus)
	addressQueryBus := address.QueryServiceMessageBus(addressQueryService)
	addressService := &root.AddressService{
		Session:     session,
		AddressAggr: addressCommandBus,
		AddressQS:   addressQueryBus,
	}
	invitationConfig := cfg.Invitation
	customerQuery := query3.NewCustomerQuery(mainDB)
	customeringQueryBus := query3.CustomerQueryMessageBus(customerQuery)
	invitationAggregate := aggregate2.NewInvitationAggregate(mainDB, invitationConfig, customeringQueryBus, queryBus, busBus, smsClient, emailClient, accountUserStoreInterface, shopStoreInterface, userStoreInterface, store)
	invitationCommandBus := aggregate2.InvitationAggregateMessageBus(invitationAggregate)
	authorizationAggregate := &aggregate3.AuthorizationAggregate{
		Auth:             authorizer,
		AccountUserStore: accountUserStoreInterface,
		ShopStore:        shopStoreInterface,
	}
	authorizationCommandBus := aggregate3.AuthorizationAggregateMessageBus(authorizationAggregate)
	accountRelationshipService := &root.AccountRelationshipService{
		Session:           session,
		InvitationAggr:    invitationCommandBus,
		InvitationQuery:   invitationQueryBus,
		AuthorizationAggr: authorizationCommandBus,
		UserStore:         userStoreFactory,
		AccountUserStore:  accountUserStoreInterface,
	}
	userRelationshipService := &root.UserRelationshipService{
		Session:                session,
		InvitationAggr:         invitationCommandBus,
		InvitationQuery:        invitationQueryBus,
		AuthorizationAggregate: authorizationCommandBus,
		ShopStore:              shopStoreInterface,
		UserStore:              userStoreInterface,
	}
	ticketQuery := query4.NewTicketQuery(store, busBus, mainDB)
	ticketQueryBus := query4.TicketQueryMessageBus(ticketQuery)
	ticketService := &_all.TicketService{
		Session:     session,
		TicketQuery: ticketQueryBus,
	}
	ecomService := &root.EcomService{
		Session:        session,
		SessionStarter: sessionStarter,
	}
	emailConfig := cfg.Email
	servers, cleanup := _all.NewServers(miscService, userService, accountService, locationService, bankService, addressService, accountRelationshipService, userRelationshipService, ticketService, ecomService, store, emailConfig, smsConfig)
	shopMiscService := &shop.MiscService{
		Session: session,
	}
	queryQueryService := query5.New(mainDB)
	catalogQueryBus := query5.QueryServiceMessageBus(queryQueryService)
	aggregateAggregate := aggregate4.New(busBus, mainDB)
	catalogCommandBus := aggregate4.AggregateMessageBus(aggregateAggregate)
	brandService := &brand.BrandService{
		Session:      session,
		CatalogQuery: catalogQueryBus,
		CatalogAggr:  catalogCommandBus,
	}
	carrierQuery := query6.NewCarrierQuery(mainDB)
	carryingQueryBus := query6.CarrierQueryMessageBus(carrierQuery)
	supplierQuery := query7.NewSupplierQuery(mainDB)
	supplieringQueryBus := query7.SupplierQueryMessageBus(supplierQuery)
	traderQuery := query8.NewTraderQuery(mainDB, customeringQueryBus, carryingQueryBus, supplieringQueryBus)
	traderingQueryBus := query8.TraderQueryMessageBus(traderQuery)
	stocktakeQuery := query9.NewQueryStocktake(mainDB)
	stocktakingQueryBus := query9.StocktakeQueryMessageBus(stocktakeQuery)
	inventoryQueryService := query10.NewQueryInventory(stocktakingQueryBus, busBus, mainDB)
	inventoryQueryBus := query10.InventoryQueryServiceMessageBus(inventoryQueryService)
	orderingQueryService := ordering.NewQueryService(mainDB)
	orderingQueryBus := ordering.QueryServiceMessageBus(orderingQueryService)
	receiptQuery := query11.NewReceiptQuery(mainDB, orderingQueryBus)
	receiptingQueryBus := query11.ReceiptQueryMessageBus(receiptQuery)
	purchaseOrderQuery := query12.NewPurchaseOrderQuery(mainDB, busBus, supplieringQueryBus, inventoryQueryBus, receiptingQueryBus)
	purchaseorderQueryBus := query12.PurchaseOrderQueryMessageBus(purchaseOrderQuery)
	refundQueryService := query13.NewQueryRefund(busBus, mainDB)
	refundQueryBus := query13.RefundQueryServiceMessageBus(refundQueryService)
	purchaseRefundQueryService := query14.NewQueryPurchasePurchaseRefund(busBus, mainDB)
	purchaserefundQueryBus := query14.PurchaseRefundQueryServiceMessageBus(purchaseRefundQueryService)
	orderStore := &sqlstore.OrderStore{
		DB:           mainDB,
		LocationBus:  locationQueryBus,
		AccountStore: accountStoreInterface,
		ShopStore:    shopStoreInterface,
	}
	orderStoreInterface := sqlstore.BindOrderStore(orderStore)
	inventoryAggregate := aggregate5.NewAggregateInventory(busBus, mainDB, traderingQueryBus, purchaseorderQueryBus, stocktakingQueryBus, refundQueryBus, purchaserefundQueryBus, catalogQueryBus, orderStoreInterface)
	inventoryCommandBus := aggregate5.InventoryAggregateMessageBus(inventoryAggregate)
	inventoryService := &inventory.InventoryService{
		Session:        session,
		TraderQuery:    traderingQueryBus,
		InventoryAggr:  inventoryCommandBus,
		InventoryQuery: inventoryQueryBus,
	}
	queryService2 := query15.NewQueryService(mainDB, busBus)
	accountshipnowQueryBus := query15.QueryServiceMessageBus(queryService2)
	aggregate30 := aggregate6.NewAggregate(mainDB, busBus)
	accountshipnowCommandBus := aggregate6.AggregateMessageBus(aggregate30)
	accountAccountService := &account.AccountService{
		Session:             session,
		IdentityAggr:        commandBus,
		IdentityQuery:       queryBus,
		AddressQuery:        addressQueryBus,
		AddressAggr:         addressCommandBus,
		UserStore:           userStoreFactory,
		AccountStore:        accountStoreInterface,
		UserStoreIface:      userStoreInterface,
		AccountshipnowQuery: accountshipnowQueryBus,
		AccountshipnowAggr:  accountshipnowCommandBus,
	}
	collectionService := &collection.CollectionService{
		Session:      session,
		CatalogQuery: catalogQueryBus,
		CatalogAggr:  catalogCommandBus,
	}
	customerAggregate := aggregate7.NewCustomerAggregate(busBus, mainDB)
	customeringCommandBus := aggregate7.CustomerAggregateMessageBus(customerAggregate)
	aggregateAddressAggregate := aggregate7.NewAddressAggregate(mainDB, locationQueryBus)
	addressingCommandBus := aggregate7.AddressAggregateMessageBus(aggregateAddressAggregate)
	addressQuery := query3.NewAddressQuery(mainDB)
	addressingQueryBus := query3.AddressQueryMessageBus(addressQuery)
	customerService := &customer.CustomerService{
		Session:       session,
		LocationQuery: locationQueryBus,
		CustomerQuery: customeringQueryBus,
		CustomerAggr:  customeringCommandBus,
		AddressAggr:   addressingCommandBus,
		AddressQuery:  addressingQueryBus,
		OrderQuery:    orderingQueryBus,
		ReceiptQuery:  receiptingQueryBus,
	}
	customerGroupService := &customergroup.CustomerGroupService{
		Session:       session,
		CustomerAggr:  customeringCommandBus,
		CustomerQuery: customeringQueryBus,
	}
	shopVariantStore := &sqlstore.ShopVariantStore{
		DB: mainDB,
	}
	shopVariantStoreInterface := sqlstore.BindShopVariantStore(shopVariantStore)
	productService := &product.ProductService{
		Session:          session,
		CatalogQuery:     catalogQueryBus,
		CatalogAggr:      catalogCommandBus,
		InventoryQuery:   inventoryQueryBus,
		ShopVariantStore: shopVariantStoreInterface,
	}
	categoryService := &category.CategoryService{
		Session:      session,
		CatalogQuery: catalogQueryBus,
		CatalogAggr:  catalogCommandBus,
	}
	categoryStore := &sqlstore.CategoryStore{
		DB: mainDB,
	}
	categoryStoreInterface := sqlstore.BindCategoryStore(categoryStore)
	productSourceService := &product_source.ProductSourceService{
		Session:       session,
		ShopStore:     shopStoreInterface,
		CategoryStore: categoryStoreInterface,
	}
	orderingAggregate := ordering.NewAggregate(busBus, mainDB)
	orderingCommandBus := ordering.AggregateMessageBus(orderingAggregate)
	mapShipmentServices := shipment_all.SupportedShipmentServices()
	connectionQuery := query16.NewConnectionQuery(mainDB, mapShipmentServices)
	connectioningQueryBus := query16.ConnectionQueryMessageBus(connectionQuery)
	connectionAggregate := aggregate8.NewConnectionAggregate(mainDB, busBus)
	connectioningCommandBus := aggregate8.ConnectionAggregateMessageBus(connectionAggregate)
	queryService3 := query17.NewQueryService(mainDB)
	shippingcodeQueryBus := query17.QueryServiceMessageBus(queryService3)
	shipmentserviceQueryService := shipmentservice.NewQueryService(mainDB, store)
	shipmentserviceQueryBus := shipmentservice.QueryServiceMessageBus(shipmentserviceQueryService)
	pricelistQueryService := pricelist.NewQueryService(mainDB, store)
	pricelistQueryBus := pricelist.QueryServiceMessageBus(pricelistQueryService)
	shopshipmentpricelistQueryService := shopshipmentpricelist.NewQueryService(mainDB, store)
	shopshipmentpricelistQueryBus := shopshipmentpricelist.QueryServiceMessageBus(shopshipmentpricelistQueryService)
	shipmentpriceQueryService := shipmentprice.NewQueryService(mainDB, store, locationQueryBus, pricelistQueryBus, shopshipmentpricelistQueryBus)
	shipmentpriceQueryBus := shipmentprice.QueryServiceMessageBus(shipmentpriceQueryService)
	pricelistpromotionQueryService := pricelistpromotion.NewQueryService(mainDB, store, locationQueryBus, queryBus, shopshipmentpricelistQueryBus, pricelistQueryBus)
	pricelistpromotionQueryBus := pricelistpromotion.QueryServiceMessageBus(pricelistpromotionQueryService)
	typesDriver := shipment_all.SupportedCarrierDriver(busBus)
	connectionManager := manager.NewConnectionManager(store, connectioningQueryBus)
	shipmentManager, err := carrier.NewShipmentManager(busBus, locationQueryBus, queryBus, connectioningQueryBus, connectioningCommandBus, shippingcodeQueryBus, shipmentserviceQueryBus, shipmentpriceQueryBus, pricelistpromotionQueryBus, typesDriver, connectionManager, orderStoreInterface)
	if err != nil {
		cleanup()
		return Output{}, nil, err
	}
	addressStoreInterface := sqlstore.BindAddressStore(addressStore)
	flagFaboOrderAutoConfirmPaymentStatus := cfg.FlagFaboOrderAutoConfirmPaymentStatus
	orderLogic := &orderS.OrderLogic{
		CatalogQuery:                          catalogQueryBus,
		OrderAggr:                             orderingCommandBus,
		CustomerAggr:                          customeringCommandBus,
		CustomerQuery:                         customeringQueryBus,
		TraderAddressAggr:                     addressingCommandBus,
		TraderAddressQuery:                    addressingQueryBus,
		LocationQuery:                         locationQueryBus,
		EventBus:                              busBus,
		ShipmentManager:                       shipmentManager,
		AddressStore:                          addressStoreInterface,
		OrderStore:                            orderStoreInterface,
		FlagFaboOrderUpdatePaymentSatusConfig: flagFaboOrderAutoConfirmPaymentStatus,
	}
	faboRedis := redis2.NewFaboRedis(store)
	fbMessagingQuery := fbmessaging.NewFbMessagingQuery(mainDB, faboRedis)
	fbmessagingQueryBus := fbmessaging.FbMessagingQueryMessageBus(fbMessagingQuery)
	orderService := &order.OrderService{
		Session:          session,
		OrderAggr:        orderingCommandBus,
		CustomerQuery:    customeringQueryBus,
		OrderQuery:       orderingQueryBus,
		ReceiptQuery:     receiptingQueryBus,
		OrderLogic:       orderLogic,
		FbMessagingQuery: fbmessagingQueryBus,
		OrderStore:       orderStoreInterface,
	}
	queryService4 := query18.NewQueryService(mainDB, shipmentManager, connectioningQueryBus)
	shippingQueryBus := query18.QueryServiceMessageBus(queryService4)
	fulfillmentService := &fulfillment.FulfillmentService{
		Session:         session,
		ShipmentManager: shipmentManager,
		ShippingQuery:   shippingQueryBus,
		OrderStore:      orderStoreInterface,
	}
	shipnowQueryService := shipnow.NewQueryService(mainDB)
	shipnowQueryBus := shipnow.QueryServiceMessageBus(shipnowQueryService)
	typesConfig := shipnow_all.SupportedShipnowCarrierConfig(cfg)
	driver2 := shipnow_all.SupportedShipnowCarrierDriver()
	shipnowManager := carrier2.NewShipnowManager(locationQueryBus, connectioningQueryBus, connectioningCommandBus, store, connectionManager, queryBus, shipnowQueryBus, accountshipnowQueryBus, accountshipnowCommandBus, typesConfig, driver2)
	shipnowAggregate := shipnow.NewAggregate(busBus, mainDB, locationQueryBus, queryBus, addressQueryBus, connectioningQueryBus, orderingQueryBus, shipnowManager)
	shipnowCommandBus := shipnow.AggregateMessageBus(shipnowAggregate)
	shipnowService := &shipnow2.ShipnowService{
		Session:      session,
		ShipnowAggr:  shipnowCommandBus,
		ShipnowQuery: shipnowQueryBus,
	}
	historyStore := &sqlstore.HistoryStore{
		DB: mainDB,
	}
	historyStoreInterface := sqlstore.BindHistoryStore(historyStore)
	historyService := &history.HistoryService{
		Session:      session,
		HistoryStore: historyStoreInterface,
	}
	moneyTxQuery := query19.NewMoneyTxQuery(mainDB, shippingQueryBus)
	moneytxQueryBus := query19.MoneyTxQueryMessageBus(moneyTxQuery)
	moneyTransactionService := &money_transaction.MoneyTransactionService{
		Session:      session,
		MoneyTxQuery: moneytxQueryBus,
	}
	dashboardQuery := query20.NewDashboardQuery(mainDB, store, locationQueryBus)
	summaryQueryBus := query20.DashboardQueryMessageBus(dashboardQuery)
	summarySummary := summary.New(mainDB)
	etelecomDB := databases.Etelecom
	queryService5 := query21.NewQueryService(mainDB, etelecomDB, queryBus)
	transactionQueryBus := query21.QueryServiceMessageBus(queryService5)
	summaryService := &summary2.SummaryService{
		Session:          session,
		SummaryQuery:     summaryQueryBus,
		SummaryOld:       summarySummary,
		TransactionQuery: transactionQueryBus,
	}
	eventStream := eventstream.New(ctx)
	configDirs := cfg.ExportDirs
	driverConfig := cfg.StorageDriver
	bucket, err := storage_all.Build(ctx, driverConfig)
	if err != nil {
		cleanup()
		return Output{}, nil, err
	}
	exportAttemptStoreFactory := sqlstore.NewExportAttemptStore(mainDB)
	queryService6 := query22.NewQueryService(etelecomDB, connectioningQueryBus)
	etelecomQueryBus := query22.QueryServiceMessageBus(queryService6)
	telecomStore := &telecom.TelecomStore{
		TelecomDB: etelecomDB,
	}
	telecomStoreInterface := telecom.BindTelecomStore(telecomStore)
	exportService, cleanup2 := export.New(store, eventStream, configDirs, bucket, exportAttemptStoreFactory, orderStoreInterface, queryBus, etelecomQueryBus, telecomStoreInterface)
	exportExportService := &export2.ExportService{
		Session:     session,
		Auth:        authorizer,
		ExportInner: exportService,
	}
	notifierDB := databases.Notifier
	notificationStore := sqlstore2.NewNotificationStore(notifierDB, accountUserStoreInterface)
	deviceStore := sqlstore2.NewDeviceStore(notifierDB)
	notificationService := &notification.NotificationService{
		Session:           session,
		NotificationStore: notificationStore,
		DeviceStore:       deviceStore,
	}
	authorizeService := &authorize.AuthorizeService{
		Session:      session,
		PartnerStore: partnerStoreInterface,
	}
	tradingService := &trading.TradingService{
		Session:        session,
		EventBus:       busBus,
		IdentityQuery:  queryBus,
		CatalogQuery:   catalogQueryBus,
		OrderQuery:     orderingQueryBus,
		InventoryQuery: inventoryQueryBus,
		OrderLogic:     orderLogic,
		OrderStore:     orderStoreInterface,
	}
	clientConfig := cfg.VTPay
	vtpayProvider := vtpay.New(clientConfig)
	config2 := cfg.KPay
	kpayProvider := kpay.New(config2)
	v3 := payment_all.AllSupportedPaymentProviders(vtpayProvider, kpayProvider)
	paymentManager := manager2.NewManager(v3, orderingQueryBus)
	managerCommandBus := manager2.ManagerMesssageBus(paymentManager)
	aggregate31 := aggregate9.NewAggregate(mainDB, busBus)
	paymentCommandBus := aggregate9.AggregateMessageBus(aggregate31)
	creditQueryService := credit.NewQueryCredit(busBus, mainDB, etelecomDB, queryBus)
	creditQueryBus := credit.CreditQueryServiceMessageBus(creditQueryService)
	paymentService := &payment.PaymentService{
		Session:        session,
		PaymentManager: managerCommandBus,
		PaymentAggr:    paymentCommandBus,
		CreditQuery:    creditQueryBus,
	}
	ledgerQuery := query23.NewLedgerQuery(mainDB)
	ledgeringQueryBus := query23.LedgerQueryMessageBus(ledgerQuery)
	receiptAggregate := aggregate10.NewReceiptAggregate(mainDB, busBus, traderingQueryBus, ledgeringQueryBus, orderingQueryBus, customeringQueryBus, carryingQueryBus, supplieringQueryBus, purchaseorderQueryBus)
	receiptingCommandBus := aggregate10.ReceiptAggregateMessageBus(receiptAggregate)
	receiptService := &receipt.ReceiptService{
		Session:          session,
		CarrierQuery:     carryingQueryBus,
		CustomerQuery:    customeringQueryBus,
		LedgerQuery:      ledgeringQueryBus,
		ReceiptAggr:      receiptingCommandBus,
		ReceiptQuery:     receiptingQueryBus,
		SupplierQuery:    supplieringQueryBus,
		TraderQuery:      traderingQueryBus,
		AccountUserStore: accountUserStoreInterface,
	}
	supplierAggregate := aggregate11.NewSupplierAggregate(busBus, mainDB)
	supplieringCommandBus := aggregate11.SupplierAggregateMessageBus(supplierAggregate)
	supplierService := &supplier.SupplierService{
		Session:            session,
		CatalogQuery:       catalogQueryBus,
		PurchaseOrderQuery: purchaseorderQueryBus,
		ReceiptQuery:       receiptingQueryBus,
		SupplierAggr:       supplieringCommandBus,
		SupplierQuery:      supplieringQueryBus,
	}
	carrierAggregate := aggregate12.NewCarrierAggregate(busBus, mainDB)
	carryingCommandBus := aggregate12.CarrierAggregateMessageBus(carrierAggregate)
	carrierService := &carrier3.CarrierService{
		Session:      session,
		CarrierAggr:  carryingCommandBus,
		CarrierQuery: carryingQueryBus,
	}
	ledgerAggregate := aggregate13.NewLedgerAggregate(mainDB, receiptingQueryBus)
	ledgeringCommandBus := aggregate13.LedgerAggregateMessageBus(ledgerAggregate)
	ledgerService := &ledger.LedgerService{
		Session:     session,
		LedgerAggr:  ledgeringCommandBus,
		LedgerQuery: ledgeringQueryBus,
	}
	purchaseOrderAggregate := aggregate14.NewPurchaseOrderAggregate(mainDB, busBus, catalogQueryBus, supplieringQueryBus, inventoryQueryBus)
	purchaseorderCommandBus := aggregate14.PurchaseOrderAggregateMessageBus(purchaseOrderAggregate)
	purchaseOrderService := &purchase_order.PurchaseOrderService{
		Session:            session,
		PurchaseOrderAggr:  purchaseorderCommandBus,
		PurchaseOrderQuery: purchaseorderQueryBus,
	}
	stocktakeAggregate := aggregate15.NewAggregateStocktake(mainDB, busBus, store)
	stocktakingCommandBus := aggregate15.StocktakeAggregateMessageBus(stocktakeAggregate)
	stocktakeService := &stocktake.StocktakeService{
		Session:        session,
		CatalogQuery:   catalogQueryBus,
		StocktakeAggr:  stocktakingCommandBus,
		StocktakeQuery: stocktakingQueryBus,
		InventoryQuery: inventoryQueryBus,
	}
	aggregate32 := aggregate16.NewAggregate(mainDB, busBus, locationQueryBus, orderingQueryBus, shipmentManager, connectioningQueryBus, queryBus, addressQueryBus)
	shippingCommandBus := aggregate16.AggregateMessageBus(aggregate32)
	shipmentService := &shipment.ShipmentService{
		Session:           session,
		ShipmentManager:   shipmentManager,
		ShippingAggregate: shippingCommandBus,
		OrderStore:        orderStoreInterface,
	}
	shopSettingUtil := util.NewShopSettingUtil(store)
	shopSettingQuery := query24.NewShopSettingQuery(mainDB, shopSettingUtil)
	settingQueryBus := query24.ShopSettingQueryMessageBus(shopSettingQuery)
	connectionService := &connection.ConnectionService{
		Session:            session,
		ShipmentManager:    shipmentManager,
		ConnectionQuery:    connectioningQueryBus,
		ConnectionAggr:     connectioningCommandBus,
		IdentityQuery:      queryBus,
		AccountshipnowAggr: accountshipnowCommandBus,
		ShopSettingQuery:   settingQueryBus,
	}
	refundAggregate := aggregate17.NewRefundAggregate(mainDB, busBus, orderStoreInterface)
	refundCommandBus := aggregate17.RefundAggregateMessageBus(refundAggregate)
	refundService := &refund.RefundService{
		Session:        session,
		CustomerQuery:  customeringQueryBus,
		InventoryQuery: inventoryQueryBus,
		ReceiptQuery:   receiptingQueryBus,
		RefundAggr:     refundCommandBus,
		RefundQuery:    refundQueryBus,
		OrderStore:     orderStoreInterface,
	}
	purchaseRefundAggregate := aggregate18.NewPurchaseRefundAggregate(mainDB, busBus, purchaseorderQueryBus)
	purchaserefundCommandBus := aggregate18.PurchaseRefundAggregateMessageBus(purchaseRefundAggregate)
	purchaseRefundService := &purchase_refund.PurchaseRefundService{
		Session:             session,
		PurchaseRefundAggr:  purchaserefundCommandBus,
		PurchaseRefundQuery: purchaserefundQueryBus,
		SupplierQuery:       supplieringQueryBus,
		PurchaseOrderQuery:  purchaseorderQueryBus,
		InventoryQuery:      inventoryQueryBus,
	}
	webServerDB := databases.WebServer
	webserverAggregate := aggregate19.New(busBus, webServerDB, catalogQueryBus)
	webserverCommandBus := aggregate19.WebserverAggregateMessageBus(webserverAggregate)
	webserverQueryService := query25.New(busBus, webServerDB, catalogQueryBus)
	webserverQueryBus := query25.WebserverQueryServiceMessageBus(webserverQueryService)
	webServerService := &ws.WebServerService{
		Session:        session,
		CatalogQuery:   catalogQueryBus,
		WebserverAggr:  webserverCommandBus,
		WebserverQuery: webserverQueryBus,
		InventoryQuery: inventoryQueryBus,
	}
	subrProductQuery := subscriptionproduct.NewSubrProductQuery(mainDB)
	subscriptionproductQueryBus := subscriptionproduct.SubrProductQueryMessageBus(subrProductQuery)
	subrPlanQuery := subscriptionplan.NewSubrPlanQuery(mainDB, subscriptionproductQueryBus)
	subscriptionplanQueryBus := subscriptionplan.SubrPlanQueryMessageBus(subrPlanQuery)
	subscriptionQuery := subscription.NewSubscriptionQuery(mainDB, subscriptionplanQueryBus, subscriptionproductQueryBus)
	subscriptionQueryBus := subscription.SubscriptionQueryMessageBus(subscriptionQuery)
	subscriptionAggregate := subscription.NewSubscriptionAggregate(mainDB, subscriptionplanQueryBus)
	subscriptionCommandBus := subscription.SubscriptionAggregateMessageBus(subscriptionAggregate)
	subscriptionService := &subscription2.SubscriptionService{
		Session:           session,
		SubscriptionQuery: subscriptionQueryBus,
		SubscriptionAggr:  subscriptionCommandBus,
		SubrProductQuery:  subscriptionproductQueryBus,
		SubrPlanQuery:     subscriptionplanQueryBus,
	}
	contactQuery := query26.NewContactQuery(mainDB)
	contactQueryBus := query26.ContactQueryMessageBus(contactQuery)
	driver3 := ticket_all.SupportedTicketDriver(busBus, shippingQueryBus, contactQueryBus)
	ticketManager, err := provider.NewTicketManager(connectionManager, busBus, driver3, connectioningQueryBus)
	if err != nil {
		cleanup2()
		cleanup()
		return Output{}, nil, err
	}
	ticketAggregate := aggregate20.NewTicketAggregate(busBus, mainDB, moneytxQueryBus, shippingQueryBus, orderingQueryBus, queryBus, ticketManager, connectioningQueryBus, contactQueryBus, store)
	ticketCommandBus := aggregate20.TicketAggregateMessageBus(ticketAggregate)
	ticketTicketService := &ticket.TicketService{
		Session:     session,
		TicketQuery: ticketQueryBus,
		TicketAggr:  ticketCommandBus,
	}
	accountShipnowService := &accountshipnow.AccountShipnowService{
		Session:             session,
		AccountshipnowQuery: accountshipnowQueryBus,
	}
	contactAggregate := aggregate21.NewContactAggregate(mainDB)
	contactCommandBus := aggregate21.ContactAggregateMessageBus(contactAggregate)
	contactService := &contact.ContactService{
		Session:      session,
		ContactQuery: contactQueryBus,
		ContactAggr:  contactCommandBus,
	}
	creditAggregate := credit.NewAggregateCredit(busBus, mainDB, queryBus)
	creditCommandBus := credit.CreditAggregateMessageBus(creditAggregate)
	creditService := &credit2.CreditService{
		Session:    session,
		CreditAggr: creditCommandBus,
	}
	shopSettingAggregate := aggregate22.NewShopSettingAggregate(mainDB, addressCommandBus, shopSettingUtil)
	settingCommandBus := aggregate22.ShopSettingAggregateMessageBus(shopSettingAggregate)
	settingService := &setting.SettingService{
		Session:      session,
		SettingQuery: settingQueryBus,
		SettingAggr:  settingCommandBus,
		AddressQ:     addressQueryBus,
	}
	driver4 := _all2.SupportedTelecomDriver(busBus)
	adminPortsipConfig := cfg.AdminPortsip
	administratorTelecom := _all2.SupportAdminPortsipDriver(adminPortsipConfig)
	telecomManager, err := provider2.NewTelecomManager(busBus, connectionManager, driver4, connectioningQueryBus, connectioningCommandBus, queryBus, etelecomQueryBus, administratorTelecom)
	if err != nil {
		cleanup2()
		cleanup()
		return Output{}, nil, err
	}
	invoiceAggregate := invoicing.NewInvoiceAggregate(mainDB, busBus, paymentCommandBus, subscriptionQueryBus, subscriptionplanQueryBus)
	invoicingCommandBus := invoicing.InvoiceAggregateMessageBus(invoiceAggregate)
	etelecomAggregate := aggregate23.NewEtelecomAggregate(mainDB, etelecomDB, busBus, contactQueryBus, telecomManager, connectioningQueryBus, queryBus, subscriptionplanQueryBus, subscriptionQueryBus, subscriptionCommandBus, invoicingCommandBus, etelecomQueryBus)
	etelecomCommandBus := aggregate23.AggregateMessageBus(etelecomAggregate)
	summaryQuery := query27.NewSummaryQuery(etelecomDB, store)
	queryBus2 := query27.SummaryQueryMessageBus(summaryQuery)
	etelecomService := &etelecom.EtelecomService{
		Session:         session,
		EtelecomAggr:    etelecomCommandBus,
		EtelecomQuery:   etelecomQueryBus,
		SummaryQuery:    queryBus2,
		IdentityAggr:    commandBus,
		IdentityQuery:   queryBus,
		ConnectionQuery: connectioningQueryBus,
	}
	userSettingAggregate := usersetting.NewUserSettingAggregate(etelecomDB)
	usersettingCommandBus := usersetting.AggerateMessageBus(userSettingAggregate)
	usersettingQueryService := usersetting.NewQueryService(etelecomDB)
	usersettingQueryBus := usersetting.QueryServiceMessageBus(usersettingQueryService)
	etelecomUserService := &etelecomuser.EtelecomUserService{
		Session:          session,
		UserSettingAggr:  usersettingCommandBus,
		UserSettingQuery: usersettingQueryBus,
	}
	aggregate33 := aggregate24.NewAggregate(mainDB)
	transactionCommandBus := aggregate24.AggregateMessageBus(aggregate33)
	transactionService := &transaction.TransactionService{
		Session:          session,
		TransactionAggr:  transactionCommandBus,
		TransactionQuery: transactionQueryBus,
	}
	invoiceQuery := invoicing.NewInvoiceQuery(mainDB)
	invoicingQueryBus := invoicing.InvoiceQueryMessageBus(invoiceQuery)
	invoiceService := &invoice.InvoiceService{
		Session:      session,
		InvoiceAggr:  invoicingCommandBus,
		InvoiceQuery: invoicingQueryBus,
	}
	config3 := cfg.Jira
	jiraDriver := driver.New(config3)
	jiraService := &jira.JiraService{
		Session: session,
		Driver:  jiraDriver,
	}
	accountUserService := &account_user.AccountUserService{
		Session:       session,
		IdentityAggr:  commandBus,
		IdentityQuery: queryBus,
	}
	departmentAggregate := aggregate25.NewDepartmentAggregate(mainDB, busBus, queryBus)
	departmentCommandBus := aggregate25.DepartmentAggregateMessageBus(departmentAggregate)
	departmentService := &department.DepartmentService{
		Session:              session,
		DepartmentGroupAggr:  departmentCommandBus,
		DepartmentGroupQuery: departmentQueryBus,
	}
	shopServers := shop_all.NewServers(store, shopMiscService, brandService, inventoryService, accountAccountService, collectionService, customerService, customerGroupService, productService, categoryService, productSourceService, orderService, fulfillmentService, shipnowService, historyService, moneyTransactionService, summaryService, exportExportService, notificationService, authorizeService, tradingService, paymentService, receiptService, supplierService, carrierService, ledgerService, purchaseOrderService, stocktakeService, shipmentService, connectionService, refundService, purchaseRefundService, webServerService, subscriptionService, ticketTicketService, accountShipnowService, contactService, creditService, settingService, etelecomService, etelecomUserService, transactionService, invoiceService, jiraService, accountUserService, departmentService)
	adminMiscService := admin.MiscService{
		Session: session,
		Login:   loginInterface,
	}
	accountAuthStoreFactory := sqlstore.NewAccountAuthStore(mainDB)
	adminAccountService := admin.AccountService{
		Session:          session,
		AccountAuthStore: accountAuthStoreFactory,
		UserStore:        userStoreFactory,
		PartnerStore:     partnerStoreInterface,
		AccountUserStore: accountUserStoreInterface,
	}
	adminAccountUserService := admin.AccountUserService{
		Session:       session,
		IdentityQuery: queryBus,
	}
	adminOrderService := admin.OrderService{
		Session:    session,
		OrderStore: orderStoreInterface,
	}
	adminFulfillmentService := admin.FulfillmentService{
		Session:       session,
		EventBus:      busBus,
		IdentityQuery: queryBus,
		RedisStore:    store,
		ShippingAggr:  shippingCommandBus,
		ShippingQuery: shippingQueryBus,
		OrderStore:    orderStoreInterface,
	}
	moneyTxAggregate := aggregate26.NewMoneyTxAggregate(mainDB, shippingQueryBus, queryBus, busBus)
	moneytxCommandBus := aggregate26.MoneyTxAggregateMessageBus(moneyTxAggregate)
	adminMoneyTransactionService := admin.MoneyTransactionService{
		Session:      session,
		MoneyTxQuery: moneytxQueryBus,
		MoneyTxAggr:  moneytxCommandBus,
	}
	shopService := admin.ShopService{
		Session:       session,
		IdentityQuery: queryBus,
		IdentityAggr:  commandBus,
		ShopStore:     shopStoreInterface,
		MoneyTxQuery:  moneytxQueryBus,
	}
	adminCreditService := admin.CreditService{
		Session:     session,
		CreditAggr:  creditCommandBus,
		CreditQuery: creditQueryBus,
	}
	adminNotificationService := admin.NotificationService{
		Session:           session,
		NotificationStore: notificationStore,
	}
	adminConnectionService := admin.ConnectionService{
		Session:         session,
		SettingAggr:     settingCommandBus,
		ConnectionAggr:  connectioningCommandBus,
		ConnectionQuery: connectioningQueryBus,
		SettingQuery:    settingQueryBus,
	}
	shipmentpriceAggregate := shipmentprice.NewAggregate(mainDB, store, pricelistQueryBus, shipmentserviceQueryBus)
	shipmentpriceCommandBus := shipmentprice.AggregateMessageBus(shipmentpriceAggregate)
	shipmentserviceAggregate := shipmentservice.NewAggregate(mainDB, store)
	shipmentserviceCommandBus := shipmentservice.AggregateMessageBus(shipmentserviceAggregate)
	pricelistAggregate := pricelist.NewAggregate(mainDB, busBus, shopshipmentpricelistQueryBus)
	pricelistCommandBus := pricelist.AggregateMessageBus(pricelistAggregate)
	shopshipmentpricelistAggregate := shopshipmentpricelist.NewAggregate(mainDB, pricelistQueryBus)
	shopshipmentpricelistCommandBus := shopshipmentpricelist.AggregateMessageBus(shopshipmentpricelistAggregate)
	pricelistpromotionAggregate := pricelistpromotion.NewAggregate(mainDB, pricelistQueryBus)
	pricelistpromotionCommandBus := pricelistpromotion.AggregateMessageBus(pricelistpromotionAggregate)
	shipmentPriceService := admin.ShipmentPriceService{
		Session:                    session,
		ShipmentManager:            shipmentManager,
		ShipmentPriceAggr:          shipmentpriceCommandBus,
		ShipmentPriceQuery:         shipmentpriceQueryBus,
		ShipmentServiceQuery:       shipmentserviceQueryBus,
		ShipmentServiceAggr:        shipmentserviceCommandBus,
		ShipmentPriceListAggr:      pricelistCommandBus,
		ShipmentPriceListQuery:     pricelistQueryBus,
		ShopShipmentPriceListQuery: shopshipmentpricelistQueryBus,
		ShopShipmentPriceListAggr:  shopshipmentpricelistCommandBus,
		PriceListPromotionQuery:    pricelistpromotionQueryBus,
		PriceListPromotionAggr:     pricelistpromotionCommandBus,
	}
	locationAggregate := location.NewAggregate(mainDB)
	locationCommandBus := location.AggregateMessageBus(locationAggregate)
	adminLocationService := admin.LocationService{
		Session:       session,
		LocationAggr:  locationCommandBus,
		LocationQuery: locationQueryBus,
	}
	subrProductAggregate := subscriptionproduct.NewSubrProductAggregate(mainDB)
	subscriptionproductCommandBus := subscriptionproduct.SubrProductAggregateMessageBus(subrProductAggregate)
	subrPlanAggregate := subscriptionplan.NewSubrPlanAggregate(mainDB)
	subscriptionplanCommandBus := subscriptionplan.SubrPlanAggregateMessageBus(subrPlanAggregate)
	adminSubscriptionService := admin.SubscriptionService{
		Session:           session,
		SubrProductAggr:   subscriptionproductCommandBus,
		SubrProductQuery:  subscriptionproductQueryBus,
		SubrPlanAggr:      subscriptionplanCommandBus,
		SubrPlanQuery:     subscriptionplanQueryBus,
		SubscriptionQuery: subscriptionQueryBus,
		SubscriptionAggr:  subscriptionCommandBus,
		InvoiceAggr:       invoicingCommandBus,
		InvoiceQuery:      invoicingQueryBus,
	}
	adminUserService := admin.UserService{
		Session:       session,
		IdentityQuery: queryBus,
		IdentityAggr:  commandBus,
		RedisStore:    store,
	}
	adminTicketService := admin.TicketService{
		Session:        session,
		TicketQuery:    ticketQueryBus,
		TicketAggr:     ticketCommandBus,
		IndentityQuery: queryBus,
	}
	adminEtelecomService := admin.EtelecomService{
		Session:          session,
		EtelecomAggr:     etelecomCommandBus,
		EtelecomQuery:    etelecomQueryBus,
		UserSettingAggr:  usersettingCommandBus,
		UserSettingQuery: usersettingQueryBus,
		IdentityQuery:    queryBus,
	}
	adminInvoiceService := admin.InvoiceService{
		Session:      session,
		InvoiceAggr:  invoicingCommandBus,
		InvoiceQuery: invoicingQueryBus,
	}
	adminTransactionService := admin.TransactionService{
		Session:          session,
		TransactionQuery: transactionQueryBus,
		TransactionAggr:  transactionCommandBus,
	}
	adminServers := admin_all.NewServers(store, adminMiscService, adminAccountService, adminAccountUserService, adminOrderService, adminFulfillmentService, adminMoneyTransactionService, shopService, adminCreditService, adminNotificationService, adminConnectionService, shipmentPriceService, adminLocationService, adminSubscriptionService, adminUserService, adminTicketService, adminEtelecomService, adminInvoiceService, adminTransactionService)
	sadminMiscService := &sadmin.MiscService{
		Session: session,
	}
	sadminUserService := &sadmin.UserService{
		Session:          session,
		AccountUserStore: accountUserStore,
		UserStore:        userStoreInterface,
	}
	webhookCallbackService := sadmin.NewWebhookCallbackService(store)
	webhookService := &sadmin.WebhookService{
		Session:                session,
		WebhookCallbackService: webhookCallbackService,
	}
	sadminServers := sadmin.NewServers(sadminMiscService, sadminUserService, webhookService)
	integrationMiscService := &integration.MiscService{}
	integrationService := &integration.IntegrationService{
		Session:          session,
		AuthStore:        generator,
		TokenStore:       tokenStore,
		SMSClient:        smsClient,
		EmailClient:      emailClient,
		UserStore:        userStoreInterface,
		AccountStore:     accountStoreInterface,
		AccountUserStore: accountUserStoreInterface,
		PartnerStore:     partnerStoreInterface,
		ShopStore:        shopStoreInterface,
		IdentityAggr:     commandBus,
	}
	integrationServers, cleanup3 := integration.NewIntegrationServer(store, integrationMiscService, integrationService)
	affiliateMiscService := affiliate.MiscService{}
	affiliateAccountService := affiliate.AccountService{
		Session:      session,
		IdentityAggr: commandBus,
	}
	affiliateServers := affiliate.NewServers(affiliateMiscService, affiliateAccountService)
	affiliateDB := databases.Affiliate
	affiliateAggregate := affiliate2.NewAggregate(affiliateDB, queryBus, catalogQueryBus, orderingQueryBus)
	affiliateCommandBus := affiliate2.AggregateMessageBus(affiliateAggregate)
	apiUserService := &api.UserService{
		Session:       session,
		AffiliateAggr: affiliateCommandBus,
	}
	affiliateQueryService := affiliate2.NewQuery(affiliateDB)
	affiliateQueryBus := affiliate2.QueryServiceMessageBus(affiliateQueryService)
	apiTradingService := &api.TradingService{
		Session:        session,
		AffiliateAggr:  affiliateCommandBus,
		AffiliateQuery: affiliateQueryBus,
		CatalogQuery:   catalogQueryBus,
		InventoryQuery: inventoryQueryBus,
	}
	apiShopService := &api.ShopService{
		Session:        session,
		CatalogQuery:   catalogQueryBus,
		InventoryQuery: inventoryQueryBus,
		AffiliateQuery: affiliateQueryBus,
	}
	affiliateService := &api.AffiliateService{
		Session:        session,
		AffiliateAggr:  affiliateCommandBus,
		CatalogQuery:   catalogQueryBus,
		AffiliateQuery: affiliateQueryBus,
		IdentityQuery:  queryBus,
		OrderStore:     orderStoreInterface,
	}
	apiServers := api.NewServers(apiUserService, apiTradingService, apiShopService, affiliateService)
	captchaConfig := cfg.Captcha
	captchaCaptcha := captcha.New(captchaConfig)
	intHandlers, err := server_max.BuildIntHandlers(servers, shopServers, adminServers, sadminServers, integrationServers, affiliateServers, apiServers, captchaCaptcha)
	if err != nil {
		cleanup3()
		cleanup2()
		cleanup()
		return Output{}, nil, err
	}
	shippingShipping := shipping.New(locationQueryBus, mainDB, shipmentManager, shippingCommandBus, shippingQueryBus, orderLogic, shipnowCommandBus, shipnowQueryBus, orderStoreInterface)
	partnerMiscService := &partner.MiscService{
		Session:  session,
		Shipping: shippingShipping,
	}
	partnerShopService := &partner.ShopService{
		Session:      session,
		PartnerStore: partnerStoreInterface,
	}
	kafka := cfg.Kafka
	producer, err := _producer.SupportedProducers(ctx, kafka)
	if err != nil {
		cleanup3()
		cleanup2()
		cleanup()
		return Output{}, nil, err
	}
	service2 := webhook.New(mainDB, producer, store)
	partnerWebhookService := &partner.WebhookService{
		Session:      session,
		WebhookInner: service2,
	}
	partnerHistoryService := &partner.HistoryService{}
	shippingService := &partner.ShippingService{
		Session:  session,
		Shipping: shippingShipping,
	}
	partnerOrderService := &partner.OrderService{
		Session:  session,
		Shipping: shippingShipping,
	}
	partnerFulfillmentService := &partner.FulfillmentService{
		Session:  session,
		Shipping: shippingShipping,
	}
	shoppingShopping := &shopping.Shopping{
		LocationQuery:     locationQueryBus,
		CustomerQuery:     customeringQueryBus,
		CustomerAggregate: customeringCommandBus,
		AddressQuery:      addressingQueryBus,
		AddressAggregate:  addressingCommandBus,
		InventoryQuery:    inventoryQueryBus,
		CatalogQuery:      catalogQueryBus,
		CatalogAggregate:  catalogCommandBus,
	}
	partnerCustomerService := &partner.CustomerService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	customerAddressService := &partner.CustomerAddressService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	partnerCustomerGroupService := &partner.CustomerGroupService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	customerGroupRelationshipService := &partner.CustomerGroupRelationshipService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	partnerInventoryService := &partner.InventoryService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	variantService := &partner.VariantService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	partnerProductService := &partner.ProductService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	productCollectionService := &partner.ProductCollectionService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	productCollectionRelationshipService := &partner.ProductCollectionRelationshipService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	bankStatementAggregate := bankstatement.NewAggregateBankStatement(busBus, mainDB, queryBus)
	bankstatementCommandBus := bankstatement.BankStatementAggregateMessageBus(bankStatementAggregate)
	internalService := &partner.InternalService{
		Session:           session,
		BankStatementAggr: bankstatementCommandBus,
	}
	partnerServers, cleanup4 := partner.NewServers(store, generator, partnerAuthURL, partnerMiscService, partnerShopService, partnerWebhookService, partnerHistoryService, shippingService, partnerOrderService, partnerFulfillmentService, partnerCustomerService, customerAddressService, partnerCustomerGroupService, customerGroupRelationshipService, partnerInventoryService, variantService, partnerProductService, productCollectionService, productCollectionRelationshipService, internalService)
	xshopMiscService := &xshop.MiscService{
		Session:  session,
		Shipping: shippingShipping,
	}
	xshopWebhookService := &xshop.WebhookService{
		Session:      session,
		WebhookInner: service2,
	}
	xshopHistoryService := &xshop.HistoryService{}
	xshopShippingService := &xshop.ShippingService{
		Session:  session,
		Shipping: shippingShipping,
	}
	xshopOrderService := &xshop.OrderService{
		Session:  session,
		Shipping: shippingShipping,
	}
	xshopFulfillmentService := &xshop.FulfillmentService{
		Session:  session,
		Shipping: shippingShipping,
	}
	xshopCustomerService := &xshop.CustomerService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	xshopCustomerAddressService := &xshop.CustomerAddressService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	xshopCustomerGroupService := &xshop.CustomerGroupService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	xshopCustomerGroupRelationshipService := &xshop.CustomerGroupRelationshipService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	xshopInventoryService := &xshop.InventoryService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	xshopVariantService := &xshop.VariantService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	xshopProductService := &xshop.ProductService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	xshopProductCollectionService := &xshop.ProductCollectionService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	xshopProductCollectionRelationshipService := &xshop.ProductCollectionRelationshipService{
		Session:  session,
		Shopping: shoppingShopping,
	}
	xshopShipnowService := &xshop.ShipnowService{
		Session:  session,
		Shipping: shippingShipping,
	}
	xshopEtelecomService := &xshop.EtelecomService{
		Session:       session,
		EtelecomQuery: etelecomQueryBus,
		IdentityQuery: queryBus,
	}
	xshopContactService := &xshop.ContactService{
		Session:      session,
		ContactQuery: contactQueryBus,
		ContactAggr:  contactCommandBus,
	}
	xshopServers, cleanup5 := xshop.NewServers(store, shippingShipping, xshopMiscService, xshopWebhookService, xshopHistoryService, xshopShippingService, xshopOrderService, xshopFulfillmentService, xshopCustomerService, xshopCustomerAddressService, xshopCustomerGroupService, xshopCustomerGroupRelationshipService, xshopInventoryService, xshopVariantService, xshopProductService, xshopProductCollectionService, xshopProductCollectionRelationshipService, xshopShipnowService, xshopEtelecomService, xshopContactService)
	partnercarrierMiscService := &partnercarrier.MiscService{
		Session:  session,
		Shipping: shippingShipping,
	}
	shipmentConnectionService := &partnercarrier.ShipmentConnectionService{
		Session:         session,
		ConnectionQuery: connectioningQueryBus,
		ConnectionAggr:  connectioningCommandBus,
	}
	shippingwebhookAggregate := shippingwebhook.NewAggregate(logDB)
	webhookWebhook := webhook2.New(mainDB, shippingQueryBus, shippingCommandBus, connectioningQueryBus, shippingwebhookAggregate)
	partnercarrierShipmentService := &partnercarrier.ShipmentService{
		Session:                session,
		ConnectionQuery:        connectioningQueryBus,
		ShippingAggr:           shippingCommandBus,
		ShippingQuery:          shippingQueryBus,
		ShipmentWebhookLogAggr: shippingwebhookAggregate,
		DirectWebhook:          webhookWebhook,
	}
	partnercarrierServers, cleanup6 := partnercarrier.NewServers(store, partnercarrierMiscService, shipmentConnectionService, partnercarrierShipmentService)
	importService := partnerimport.New(session, mainDB)
	partnerimportServers := partnerimport.NewServers(importService)
	shipnowService2 := xshop.ShipnowService{
		Session:  session,
		Shipping: shippingShipping,
	}
	vnPostService := &vnp.VNPostService{
		Session:        session,
		ShipnowService: shipnowService2,
	}
	vnPostWebhookService := &vnp.VNPostWebhookService{
		Session:      session,
		WebhookInner: service2,
	}
	vnpServers := vnp.NewServers(vnPostService, vnPostWebhookService)
	vhtUserService := &vht.VHTUserService{
		Session:       session,
		IdentityAggr:  commandBus,
		IdentityQuery: queryBus,
	}
	vhtServers := vht.NewServers(vhtUserService)
	extHandlers, err := server_max.BuildExtHandlers(partnerServers, xshopServers, partnercarrierServers, partnerimportServers, vnpServers, vhtServers)
	if err != nil {
		cleanup6()
		cleanup5()
		cleanup4()
		cleanup3()
		cleanup2()
		cleanup()
		return Output{}, nil, err
	}
	middlewareSessionStarter := middleware.SessionStarter{
		SAdminToken:      sAdminToken,
		IdentityQuery:    queryBus,
		TokenStore:       tokenStore,
		AccountStore:     accountStoreInterface,
		UserStore:        userStoreInterface,
		PartnerStore:     partnerStoreInterface,
		AccountUserStore: accountUserStoreInterface,
		ShopStore:        shopStoreInterface,
	}
	authxService := authx.AuthxService{
		St: middlewareSessionStarter,
	}
	authxHandler := server_max.BuildAuthxHandler(authxService)
	ghnimportImport := ghnimport.Import{
		MoneyTxAggr: moneytxCommandBus,
	}
	ghtkimportImport := ghtkimport.Import{
		MoneyTxAggr:   moneytxCommandBus,
		ShippingAggr:  shippingCommandBus,
		ShippingQuery: shippingQueryBus,
	}
	vtpostimportImport := vtpostimport.Import{
		MoneyTxAggr: moneytxCommandBus,
	}
	vtPostImporter := &vtpostimport.VTPostImporter{}
	ghtkImporter := &ghtkimport.GHTKImporter{
		ShippingAggr:  shippingCommandBus,
		ShippingQuery: shippingQueryBus,
	}
	ghnImporter := &ghnimport.GHNImporter{}
	jtImporter := &jtexpressimport.JTImporter{}
	dhlImporter := &dhlimport.DHLImporter{
		ShippingQuery: shippingQueryBus,
	}
	njvImporter := &njvimport.NJVImporter{
		ShippingAggr:  shippingCommandBus,
		ShippingQuery: shippingQueryBus,
	}
	ntxImporter := &ntximport.NTXImporter{
		ShippingAggr:  shippingCommandBus,
		ShippingQuery: shippingQueryBus,
	}
	snappyImporter := &snappyimport.SnappyImporter{}
	handlersImportService := handlers.ImportService{
		MoneyTxAggr:       moneytxCommandBus,
		ConnectionQuery:   connectioningQueryBus,
		VTPostImporter:    vtPostImporter,
		GHTKImporter:      ghtkImporter,
		GHNImporter:       ghnImporter,
		JTExpressImporter: jtImporter,
		DHLImporter:       dhlImporter,
		NJVImporter:       njvImporter,
		NTXImporter:       ntxImporter,
		SnappyImporter:    snappyImporter,
	}
	hotFixMoneyTxService := moneytx.New(mainDB)
	extensionService := extension.New(etelecomCommandBus, etelecomQueryBus, etelecomDB, queryBus)
	userUserService := user.New(etelecomCommandBus, etelecomQueryBus, etelecomDB, mainDB, commandBus, queryBus)
	accountuserAccountUserService := accountuser.New(mainDB, commandBus, queryBus)
	importServer := server_admin.BuildImportHandlers(ghnimportImport, ghtkimportImport, vtpostimportImport, handlersImportService, hotFixMoneyTxService, extensionService, userUserService, accountuserAccountUserService, session)
	dirConfigs := cfg.UploadDirs
	uploader, err := _uploader.NewUploader(ctx, dirConfigs, bucket)
	if err != nil {
		cleanup6()
		cleanup5()
		cleanup4()
		cleanup3()
		cleanup2()
		cleanup()
		return Output{}, nil, err
	}
	exportAttemptStore := sqlstore.BuildExportAttemptStore(mainDB)
	exportAttemptStoreInterface := sqlstore.BindExportAttemptStore(exportAttemptStore)
	imcsvImport, cleanup7 := imcsv.New(authorizer, locationQueryBus, store, uploader, mainDB, orderStoreInterface, exportAttemptStoreInterface)
	import2, cleanup8 := imcsv2.New(store, uploader, mainDB, exportAttemptStoreInterface, categoryStoreInterface, shopStoreInterface)
	import3, cleanup9 := imcsv3.New(store, uploader, exportAttemptStoreInterface)
	importHandler := server_shop.BuildImportHandler(imcsvImport, import2, import3, session)
	eventStreamHandler := server_shop.BuildEventStreamHandler(eventStream, session)
	downloadHandler := server_shop.BuildDownloadHandler()
	clientClient := client.New(clientConfig)
	vtpayAggregate := vtpay2.NewAggregate(mainDB, orderingQueryBus, orderingCommandBus, paymentCommandBus, clientClient)
	vtpayCommandBus := vtpay2.AggregateMessageBus(vtpayAggregate)
	aggregate34 := aggregate27.NewAggregate(orderingQueryBus, orderingCommandBus, vtpayCommandBus, clientClient)
	gatewayCommandBus := aggregate27.AggregateMessageBus(aggregate34)
	aggregate35 := aggregate28.New(logDB)
	serverServer := server.New(gatewayCommandBus, aggregate35)
	vtPayHandler := server_vtpay.BuildVTPayHandler(serverServer)
	queryService7 := query28.NewQueryService(mainDB)
	paymentQueryBus := query28.QueryServiceMessageBus(queryService7)
	server4 := server2.New(aggregate35, paymentCommandBus, paymentQueryBus)
	kPayHandler := server_kpay.BuildKPayHandler(server4)
	reportQuery := query29.NewReportQuery(orderingQueryBus, queryBus, receiptingQueryBus, catalogQueryBus, stocktakingQueryBus)
	reportingQueryBus := query29.ReportQueryMessageBus(reportQuery)
	reportService := reportserver.ReportService{
		ReportQuery:   reportingQueryBus,
		IdentityQuery: queryBus,
	}
	reportServer := reportserver.BuildReportServer(reportService, session)
	mainServer := BuildMainServer(service, intHandlers, extHandlers, authxHandler, sharedConfig, cfg, importServer, importHandler, eventStreamHandler, downloadHandler, vtPayHandler, kPayHandler, reportServer)
	webServer := BuildWebServer(cfg, webserverQueryBus, catalogQueryBus, subscriptionQueryBus, store, locationQueryBus)
	shipment_allConfig := cfg.Shipment
	webhookConfig := shipment_allConfig.GHNWebhook
	v1Webhook := v1.New(mainDB, shipmentManager, queryBus, shippingCommandBus, shippingwebhookAggregate, orderStoreInterface)
	v2Webhook := v2.New(mainDB, shipmentManager, queryBus, shippingCommandBus, shippingwebhookAggregate, orderStoreInterface)
	webhook8 := webhook3.New(mainDB, shipmentManager, queryBus, shippingCommandBus, shippingwebhookAggregate, orderStoreInterface)
	shipmentWebhookServer := _all3.NewShipmentWebhookServer(webhookConfig, v1Webhook, v2Webhook, webhook8)
	_ghtkWebhookConfig := shipment_allConfig.GHTKWebhook
	webhook9 := webhook4.New(mainDB, shipmentManager, queryBus, shippingCommandBus, shippingwebhookAggregate, orderStoreInterface)
	ghtkWebhookServer := _ghtk.NewGHTKWebhookServer(_ghtkWebhookConfig, shipmentManager, queryBus, shippingCommandBus, webhook9)
	_vtpostWebhookConfig := shipment_allConfig.VTPostWebhook
	webhook10 := webhook5.New(mainDB, shipmentManager, queryBus, shippingCommandBus, shippingwebhookAggregate, orderStoreInterface)
	vtPostWebhookServer := _vtpost.NewVTPostWebhookServer(_vtpostWebhookConfig, shipmentManager, queryBus, shippingCommandBus, webhook10)
	_ntxWebhookConfig := shipment_allConfig.NTXWebhook
	webhook11 := webhook6.New(mainDB, shipmentManager, queryBus, shippingCommandBus, shippingwebhookAggregate, orderStoreInterface)
	ntxWebhookServer := _ntx.NewNTXWebhookServer(_ntxWebhookConfig, shipmentManager, queryBus, shippingCommandBus, webhook11)
	serverWebhookConfig := cfg.AhamoveWebhook
	config4 := cfg.Ahamove
	client3 := client2.New(config4)
	urlConfig := shipnow_all.AhamoveConfig(cfg)
	ahamoveCarrier := ahamove.New(client3, urlConfig, locationQueryBus, queryBus, accountshipnowQueryBus)
	ahamoveVerificationFileServer := server3.NewAhamoveVerificationFileServer(ctx, accountshipnowQueryBus)
	webhook12 := webhook7.New(mainDB, ahamoveCarrier, shipnowQueryBus, shipnowCommandBus, orderingCommandBus, orderingQueryBus, shippingwebhookAggregate)
	ahamoveWebhookServer := server3.NewAhamoveWebhookServer(serverWebhookConfig, shipmentManager, ahamoveCarrier, queryBus, shipnowQueryBus, shipnowCommandBus, orderingCommandBus, orderingQueryBus, ahamoveVerificationFileServer, webhook12)
	v4 := BuildServers(mainServer, webServer, shipmentWebhookServer, ghtkWebhookServer, vtPostWebhookServer, ntxWebhookServer, ahamoveWebhookServer)
	processManager := pm.New(busBus, queryBus, commandBus, invitationQueryBus, addressQueryBus, addressCommandBus, accountUserStoreInterface)
	pmProcessManager := pm2.New(busBus, catalogQueryBus, orderingQueryBus, inventoryCommandBus)
	processManager2 := pm3.New(busBus, invitationQueryBus, invitationCommandBus)
	processManager3 := pm4.New(busBus, catalogQueryBus, catalogCommandBus)
	processManager4 := pm5.New(busBus, ledgeringCommandBus)
	processManager5 := pm6.New(busBus, moneytxQueryBus, moneytxCommandBus, shippingQueryBus)
	processManager6 := pm7.New(busBus, orderingCommandBus, affiliateCommandBus, receiptingQueryBus, inventoryCommandBus, orderingQueryBus, customeringQueryBus, shipnowQueryBus)
	processManager7 := pm8.New(busBus, purchaseorderQueryBus, receiptingQueryBus)
	processManager8 := pm9.New(busBus, purchaserefundCommandBus, purchaserefundQueryBus, receiptingQueryBus)
	processManager9 := pm10.New(busBus, receiptingQueryBus, receiptingCommandBus, ledgeringQueryBus, ledgeringCommandBus, queryBus, moneytxQueryBus, orderStoreInterface, shippingQueryBus)
	processManager10 := pm11.New(busBus, refundQueryBus, receiptingQueryBus, refundCommandBus)
	processManager11 := pm12.New(busBus, shipnowQueryBus, shipnowCommandBus, orderingCommandBus, shipnowManager, queryBus, addressQueryBus, accountshipnowQueryBus, accountshipnowCommandBus, connectioningCommandBus)
	processManager12 := pm13.New(busBus, shippingQueryBus, shippingCommandBus, store, connectioningQueryBus, shopStoreInterface, transactionQueryBus)
	processManager13 := pm14.New(busBus, affiliateCommandBus)
	traderAgg := aggregate29.NewTraderAgg(mainDB)
	traderingCommandBus := aggregate29.TraderAggMessageBus(traderAgg)
	processManager14 := pm15.New(busBus, traderingCommandBus)
	processManager15 := pm16.New(busBus, connectioningCommandBus, connectioningQueryBus)
	processManager16 := pm17.New(store, busBus, pricelistQueryBus, shopshipmentpricelistQueryBus)
	processManager17 := pm18.New(busBus, customeringQueryBus, customeringCommandBus, shippingQueryBus)
	processManager18 := pm19.New(busBus, etelecomCommandBus, etelecomQueryBus)
	processManager19 := pm20.New(busBus, invoicingQueryBus, invoicingCommandBus, subscriptionQueryBus, subscriptionCommandBus, subscriptionplanQueryBus, queryBus, creditCommandBus, transactionCommandBus)
	processManager20 := pm21.New(busBus, transactionQueryBus, creditQueryBus, invoicingCommandBus, invoicingQueryBus, queryBus)
	processManager21 := pm22.New(busBus, transactionQueryBus, transactionCommandBus, creditQueryBus, invoicingQueryBus)
	processManager22 := pm23.New(busBus, usersettingQueryBus, queryBus)
	processManager23 := pm24.NewProcessManager(busBus, ticketCommandBus)
	portsip_pmProcessManager := portsip_pm.New(busBus, connectionManager, connectioningQueryBus, connectioningCommandBus, telecomManager, etelecomQueryBus, etelecomCommandBus, accountAuthStoreFactory, queryBus)
	bankStatementQueryService := bankstatement.NewQueryBankStatement(mainDB, queryBus)
	bankstatementQueryBus := bankstatement.BankStatementQueryServiceMessageBus(bankStatementQueryService)
	processManager24 := pm25.New(busBus, creditCommandBus, creditQueryBus, bankstatementQueryBus)
	output := Output{
		Servers:                v4,
		Health:                 service,
		_identityPM:            processManager,
		_inventoryPM:           pmProcessManager,
		_invitationPM:          processManager2,
		_catalogPM:             processManager3,
		_ledgerPM:              processManager4,
		_moneytxPM:             processManager5,
		_orderPM:               processManager6,
		_purchaseOrderPM:       processManager7,
		_purchaseRefundPM:      processManager8,
		_receiptPM:             processManager9,
		_refundPM:              processManager10,
		_shipnowPM:             processManager11,
		_shippingPM:            processManager12,
		_affiliatePM:           processManager13,
		_traderPM:              processManager14,
		_connectionPM:          processManager15,
		_pricelistPM:           processManager16,
		_customerPM:            processManager17,
		_etelecomPM:            processManager18,
		_subscriptionPM:        processManager19,
		_invoicingPM:           processManager20,
		_transactionPM:         processManager21,
		_etelecomUserSettingPM: processManager22,
		_ticketPM:              processManager23,
		_portsipPM:             portsip_pmProcessManager,
		_creditPM:              processManager24,
	}
	return output, func() {
		cleanup9()
		cleanup8()
		cleanup7()
		cleanup6()
		cleanup5()
		cleanup4()
		cleanup3()
		cleanup2()
		cleanup()
	}, nil
}
