// Code generated by gen-cmd-query. DO NOT EDIT.

package ordering

import (
	context "context"

	orderingv1types "etop.vn/api/main/ordering/v1/types"
	meta "etop.vn/api/meta"
)

type Command interface{ command() }
type Query interface{ query() }
type CommandBus struct{ bus meta.Bus }
type QueryBus struct{ bus meta.Bus }

func (c CommandBus) Dispatch(ctx context.Context, msg Command) error {
	return c.bus.Dispatch(ctx, msg)
}
func (c QueryBus) Dispatch(ctx context.Context, msg Query) error {
	return c.bus.Dispatch(ctx, msg)
}
func (c CommandBus) DispatchAll(ctx context.Context, msgs ...Command) error {
	for _, msg := range msgs {
		if err := c.bus.Dispatch(ctx, msg); err != nil {
			return err
		}
	}
	return nil
}
func (c QueryBus) DispatchAll(ctx context.Context, msgs ...Query) error {
	for _, msg := range msgs {
		if err := c.bus.Dispatch(ctx, msg); err != nil {
			return err
		}
	}
	return nil
}

type GetOrderByIDCommand struct {
	ID int64

	Result *Order `json:"-"`
}

type GetOrdersCommand struct {
	ShopID int64
	IDs    []int64

	Result *OrdersResponse `json:"-"`
}

type ReserveOrdersForFfmCommand struct {
	OrderIDs   []int64
	Fulfill    orderingv1types.Fulfill
	FulfillIDs []int64

	Result *ReserveOrdersForFfmResponse `json:"-"`
}

type ValidateOrdersCommand struct {
	OrderIDs []int64

	Result *ValidateOrdersResponse `json:"-"`
}

// implement interfaces

func (q *GetOrderByIDCommand) command()        {}
func (q *GetOrdersCommand) command()           {}
func (q *ReserveOrdersForFfmCommand) command() {}
func (q *ValidateOrdersCommand) command()      {}

// implement conversion

func (q *GetOrderByIDCommand) GetArgs() *GetOrderByIDArgs {
	return &GetOrderByIDArgs{
		ID: q.ID,
	}
}
func (q *GetOrdersCommand) GetArgs() *GetOrdersArgs {
	return &GetOrdersArgs{
		ShopID: q.ShopID,
		IDs:    q.IDs,
	}
}
func (q *ReserveOrdersForFfmCommand) GetArgs() *ReserveOrdersForFfmArgs {
	return &ReserveOrdersForFfmArgs{
		OrderIDs:   q.OrderIDs,
		Fulfill:    q.Fulfill,
		FulfillIDs: q.FulfillIDs,
	}
}
func (q *ValidateOrdersCommand) GetArgs() *ValidateOrdersForShippingArgs {
	return &ValidateOrdersForShippingArgs{
		OrderIDs: q.OrderIDs,
	}
}

// implement dispatching

type AggregateHandler struct {
	inner Aggregate
}

func NewAggregateHandler(service Aggregate) AggregateHandler { return AggregateHandler{service} }

func (h AggregateHandler) RegisterHandlers(b interface {
	meta.Bus
	AddHandler(handler interface{})
}) CommandBus {
	b.AddHandler(h.HandleGetOrderByID)
	b.AddHandler(h.HandleGetOrders)
	b.AddHandler(h.HandleReserveOrdersForFfm)
	b.AddHandler(h.HandleValidateOrders)
	return CommandBus{b}
}

func (h AggregateHandler) HandleGetOrderByID(ctx context.Context, cmd *GetOrderByIDCommand) error {
	result, err := h.inner.GetOrderByID(ctx, cmd.GetArgs())
	cmd.Result = result
	return err
}

func (h AggregateHandler) HandleGetOrders(ctx context.Context, cmd *GetOrdersCommand) error {
	result, err := h.inner.GetOrders(ctx, cmd.GetArgs())
	cmd.Result = result
	return err
}

func (h AggregateHandler) HandleReserveOrdersForFfm(ctx context.Context, cmd *ReserveOrdersForFfmCommand) error {
	result, err := h.inner.ReserveOrdersForFfm(ctx, cmd.GetArgs())
	cmd.Result = result
	return err
}

func (h AggregateHandler) HandleValidateOrders(ctx context.Context, cmd *ValidateOrdersCommand) error {
	result, err := h.inner.ValidateOrders(ctx, cmd.GetArgs())
	cmd.Result = result
	return err
}

type QueryServiceHandler struct {
	inner QueryService
}

func NewQueryServiceHandler(service QueryService) QueryServiceHandler {
	return QueryServiceHandler{service}
}

func (h QueryServiceHandler) RegisterHandlers(b interface {
	meta.Bus
	AddHandler(handler interface{})
}) QueryBus {
	return QueryBus{b}
}
